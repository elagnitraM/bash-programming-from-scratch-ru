# Пакетный менеджер

Мы познакомились со встроенными командами Bash и со стандартным набором GNU-утилит. Эти утилиты устанавливаются в Unix-окружение по умолчанию. Их возможностей может оказаться недостаточно для решения вашей задачи. Эта проблема решается установкой дополнительных программ и утилит.

Подходы к установке программ в Windows и Unix-окружение отличаются. Рассмотрим, как правильно устанавливать и обновлять ПО в любом Unix-окружении или Linux дистрибутиве.

## Репозиторий

Любое ПО устанавливается в Unix-окружение из [**репозитория**](https://help.ubuntu.ru/wiki/репозиторий) (software repository). Репозиторием называется сервер-хранилище всех доступных приложений. Эти приложения собираются **мейнтейнерами** из исходного кода открытого ПО. Большинство мейнтейнеров — это добровольцы и энтузиасты свободного ПО.

Каждое приложение в репозитории хранится в виде файла. Эти файлы имеют специальный формат. Например, deb, RPM, zst и т.д. Разные Linux-дистрибутивы используют разные форматы. Файл с приложением называется **пакетом** (package). Пакет — это независимый модуль для установки.

Репозиторий хранит не только пакеты, но и их **индекс**. Индекс пакетов представляет собой один или несколько файлов со списком всех пакетов, доступных в репозитории.

Устанаваливать пакеты в Unix-окружение можно сразу из нескольких репозиториев. Например, один репозиторий предлагает новые версии пакетов, а другой их специальные сборки. В зависимости от требований можно выбрать из какого репозитория устанавливать пакет.

## Работа с пакетами

Для работы с репозиторием в каждом Unix-окружении есть специальная программа под названием [**пакетный менеджер**](https://ru.wikipedia.org/wiki/Система_управления_пакетами) (package manager). Может возникнуть вопрос: зачем понадобилась отдельная программа для установки нового ПО? Разве не удобнее вручную загружать и устанавливать пакеты из репозитория?

На самом деле основная задача пакетного менеджера заключается в отслеживании **зависимостей пакетов**. Зависимость пакетов возникает, когда программа из одного пакета использует возможности программы или библиотеки из другого. Этот механизм позволяет избежать многократной установки одного и того же приложения или библиотеки в систему. Вместо этого нужные пакеты устанавливаются однократно. Все зависящие от них программы знают место их расположения и используют их совместно.

Установка приложений в Unix-окружение или Linux ОС практически всегда должна выполняться через пакетный менеджер. Исключением являются проприетарные программы, которые обычно приходится устанавливать вручную. В большинстве случаев такие программы распространяются вместе со всеми своими зависимостями.

Общий алгоритм установки пакета из репозитория выглядит следующим образом:

1. Загрузить из репозитория индекс пакетов.

2. Найти нужное приложение или библиотеку в индексе пакетов.

3. Загрузить на локальный компьютер пакет с приложением или библиотекой из репозитория.

3. Установить загруженный пакет.

В окружении MSYS2 используется пакетный менеджер [pacman](https://wiki.archlinux.org/index.php/Pacman_(Русский)) из дистрибутива Arch Linux. Поэтому на его примере рассмотрим команды для работы с пакетами.

Чтобы загрузить из репозитория индекс пакетов, воспользуйтесь следующей командой:
{line-numbers: false, format: Bash}
```
pacman -Syy
```

Далее, чтобы найти в загруженном индексе пакет по ключевому слову, используйте команду:
{line-numbers: false, format: Bash}
```
pacman -Ss КЛЮЧЕВОЕ_СЛОВО
```

Предположим, что вы ищете утилиту для работы с документами MS Word. Тогда вы можете попробовать следующую команду:
{line-numbers: false, format: Bash}
```
pacman -Ss word
```

В списке результатов поиска будут два пакета: `mingw-w64-i686-antiword` и `mingw-w64-x86_64-antiword`. Это две сборки утилиты antiword для 32-разрядных и 64-разрядных систем. Утилита antiword позволяет конвертировать MS Word файлы в текстовый формат.

Чтобы установить пакет с найденным приложением, воспользуйтесь командой:
{line-numbers: false, format: Bash}
```
pacman -S ИМЯ_ПАКЕТА
```

Для нашего примера команда установки утилиты antiword будет выглядеть следующим образом:
{line-numbers: false, format: Bash}
```
pacman -S mingw-w64-x86_64-antiword
```

В результате этой команды будет установлена утилита antiword и все пакеты, которые необходимы для её работы.

После окончания процесса установки, вы можете запустить утилиту следующей командой:
{line-numbers: false, format: Bash}
```
antiword
```

Удалить установленный ранее пакет вместе с его зависимостям, которые не нужны другим программам, можно следующей командой:
{line-numbers: false, format: Bash}
```
pacman -Rs ИМЯ_ПАКЕТА
```

Для удаления утилиты antiword команда будет выглядеть так:
{line-numbers: false, format: Bash}
```
pacman -Rs mingw-w64-x86_64-antiword
```

Чтобы обновить все установленные в систему пакеты и их зависимости до текущих версий в репозитории, используйте команду:
{line-numbers: false, format: Bash}
```
pacman -Syu
```

Мы рассмотрели основные команды пакетного менеджера pacman. Пакетные менеджеры разных Linux-дистрибутивов работают по одному и тому же принципу. Поэтому у каждой из рассмотренных нами команд есть альтернатива и в ОС Ubuntu с её пакетным менеджером apt-get, и в ОС Fedora с её dnf.

Таблица 4-1 демонстрирует команды для работы с пакетами в различных дистрибутивах Linux.

{caption: "Таблица 4-1. Команды для работы с пакетами", width: "100%"}
| Команда | MSYS2 и Arch Linux | Ubuntu | CentOS | Fedora |
| --- | --- | --- | --- | --- |
| Получить индекс пакетов | `pacman -Syy` | `apt-get update` | `yum check-update` | `dnf check-update` |
|  | | | | |
| Поиск пакета по ключевому слову | `pacman -Ss КЛЮЧЕВОЕ_СЛОВО` | `apt-cache search КЛЮЧЕВОЕ_СЛОВО` | `yum search КЛЮЧЕВОЕ_СЛОВО` | `dnf search КЛЮЧЕВОЕ_СЛОВО` |
|  | | | | |
| Установить пакет из репозитория | `pacman -S ИМЯ_ПАКЕТА` | `apt-get install ИМЯ_ПАКЕТА` | `yum install ИМЯ_ПАКЕТА` | `dnf install ИМЯ_ПАКЕТА` |
|  | | | | |
| Установить пакета из локального файла | `pacman -U ИМЯ_ФАЙЛА` | `dpkg -i ИМЯ_ФАЙЛА` | `yum install ИМЯ_ФАЙЛА` | `dnf install ИМЯ_ФАЙЛА` |
|  | | | | |
| Удалить установленный пакет | `pacman -Rs ИМЯ_ПАКЕТА` | `apt-get remove ИМЯ_ПАКЕТА` | `yum remove ИМЯ_ПАКЕТА` | `dnf erase ИМЯ_ПАКЕТА` |
|  | | | | |
| Обновить все установленные пакеты | `pacman -Syu` | `apt-get upgrade` | `yum update` | `dnf upgrade` |