## Условные операторы

Мы уже встречались с условными операторами, когда знакомились с утилитой `find` и коннекторами. В языке Bash есть и другие формы операторов ветвления. Каждая из них предназначена для определённой цели. Рассмотрим инструкции `if` и `case`, которые часто оказываются полезны при разработке скриптов.

### Блоки команд

При написании однострочной команды и скрипта мы руководствуемся разными требованиями. В первом случае важна компактность. Согласитесь, что короткую команду легче набирать и шанс допустить ошибку меньше. В случае скриптов, важнее наглядность и удобство чтения.

Коннекторы `&&` и `||` хорошо подходят для однострочных команд. Но когда речь заходит о скриптах, у них появляются более удобные альтернативы. На самом деле всё зависит от конкретного случая. Иногда коннектор отлично вписывается в код скрипта, а иногда его следует заменить на более удобную инструкцию. Рассмотрим эти случаи подробнее.

Ещё раз обратимся к нашему скрипту для резервного копирования из листинга 3-9. Его первая строка выглядит следующим образом:
{line-numbers: false, format: Bash}
```
bsdtar -cjf "$1".tar.bz2 "$@" && echo "bsdtar - OK" > results.txt || { echo   "bsdtar - FAILS" > results.txt ; exit 1 ; }
```

Мы разбили вызовы утилит `bsdtar` и `cp` на две отдельные команды. Это помогло, но лишь отчасти. Вызов `bsdtar` всё ещё слишком длинный, из-за чего его неудобно читать и изменять. Это верный сигнал, что при его написании было принято неверное техническое решение.

Распишем алгоритм вызова `bsdtar` по шагам:

1. Выполнить архивирование и сжатие всех файлов и каталогов из переменной `$@`.

2. Если команда завершилась успешно, записать в лог-файл строку "bsdtar - OK".

3. Если при работе `bsdtar` произошла ошибка, записать в лог-файл строку "bsdtar - FAILS" и завершить работу скрипта.

Вопросы вызывает третий пункт. Обратите внимание, что при успешной завершении `bsdtar` выполняется только одно действие. В случае же ошибки - действий два и они объединены в [**блок**](https://www.gnu.org/software/bash/manual/html_node/Command-Grouping.html) с помощью фигурных скобок. 

Конструкция `if` была введена как раз для удобства работы с блоками команд. В общем случае она выглядит следующим образом:
{line-numbers: false}
```
if УСЛОВИЕ
then
    ДЕЙСТВИЕ
fi
```

Если требуется записать `if` в одну строку, после `if УСЛОВИЕ` и `then ДЕЙСТВИЕ` следует поставить точки с запятой:
{line-numbers: false}
```
if УСЛОВИЕ; then ДЕЙСТВИЕ; fi
```

УСЛОВИЕ и ДЕЙСТВИЕ в операторе `if` представляют собой команду или блок команд. Если УСЛОВИЕ завершилось успешно с кодом 0, будут выполнены команды, соответствующие ДЕЙСТВИЮ.

Рассмотрим простой пример:
{line-numbers: false, format: Bash}
```
if cmp file1.txt file2.txt &> /dev/null
then
    echo "Файлы file1.txt и file2.txt идентичны"
fi
```

В качестве УСЛОВИЯ мы вызываем утилиту `cmp`. Она побайтово сравнивает содержимое двух файлов, переданных на вход. Если они отличаются, `cmp` печатает в стандартный поток вывода место их первого различия. В данном случае нас интересует только код возврата утилиты, а не её вывод, поэтому мы перенаправляем его в файл [`/dev/null`](https://ru.wikipedia.org/wiki//dev/null). Запись в `dev/null` всегда происходит успешно, а все записанные данные удаляются.

Итак, если файлы `file1.txt` и `file2.txt` имеют одинаковое содержимое, команда `echo` выведет соответствующее сообщение на экран.