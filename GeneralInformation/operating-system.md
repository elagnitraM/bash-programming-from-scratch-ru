# Операционные системы

## История возникновения ОС

Подавляющее большинство пользователей компьютера понимает, зачем нужна [**операционная система**](https://ru.wikipedia.org/wiki/%D0%9E%D0%BF%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%B0%D1%8F_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0#%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8) (ОС). Как правило, при покупке или скачивании какого-то приложения вы обращаете внимание на системные требования. В них обязательно будет указано, какая ОС требуется для его запуска. Получается, что ОС — это некоторая программная платформа, которая нужна для запуска приложений. Но откуда взялось это требование? Почему нельзя просто купить компьютер и запустить на нём приложение без всякой ОС?

Эти вопросы кажутся глупыми только на первый взгляд. Подумайте сами: современные ОС ввиду своей универсальности имеют множество функций. Большая их часть каждому конкретному пользователю просто не нужна. Но несмотря на это, для обслуживания этих функций ОС активно использует ресурсы компьютера. В результате для полезной нагрузки системы, то есть приложений которые пользователь хочет запустить, ресурсов остаётся намного меньше. Это приводит к медленной работе, зависаниям и даже перезагрузкам компьютера.

На самом деле первые [электромеханические компьютеры](https://ru.wikipedia.org/wiki/%D0%A2%D0%B0%D0%B1%D1%83%D0%BB%D1%8F%D1%82%D0%BE%D1%80) не имели ОС. На них работало одно единственное приложение, выполняющее арифметические операции. Данные для этих вычислений загружались с [перфокарт](https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D1%84%D0%BE%D0%BA%D0%B0%D1%80%D1%82%D0%B0). Таким же образом выводились результаты. Несмотря на огромную стоимость таких машин и их узкую специализацию, они были востребованы и успешно применялись для переписи населения США в 1890 году. Это оказалось экономически целесообразнее ручного труда.

До тех пор пока компьютеры оставались узкоспециализированными и выполняли единственную задачу, они успешно обходились без ОС. Однако, со временем эксплуатировать такие машины стало слишком дорого. Как правило, они разрабатывались в рамках государственных проектов гражданской или [военной направленности](https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D0%BD%D1%85%D1%8D%D1%82%D1%82%D0%B5%D0%BD%D1%81%D0%BA%D0%B8%D0%B9_%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82). Компьютер создавался под конкретный проект, а затем разбирался или простаивал. Если требования проекта менялись, редко когда машину можно было перестроить для новых задач. Всё это привело к идее, а затем и созданию универсальных или программируемых компьютеров.

Впервые математическую модель универсального компьютера предложил Алан Тьюринг в 1936 году. Впоследствии эта модель стала известна как [**машина Тьюринга**](https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D1%88%D0%B8%D0%BD%D0%B0_%D0%A2%D1%8C%D1%8E%D1%80%D0%B8%D0%BD%D0%B3%D0%B0). Она описывает абстрактную автомат, который способен выполнить любой [**алгоритм**](https://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC).

Позднее в 1944 году Джон фон Нейман разработал конкретную архитектуру организации универсальной вычислительной машины. Она получила название [**архитектура фон Неймана**](https://ru.wikipedia.org/wiki/%D0%90%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0_%D1%84%D0%BE%D0%BD_%D0%9D%D0%B5%D0%B9%D0%BC%D0%B0%D0%BD%D0%B0) и применялась для создания первого в мире лампового компьютера [ENIAC](https://ru.wikipedia.org/wiki/%D0%AD%D0%9D%D0%98%D0%90%D0%9A). Для ввода и вывода информации в нём использовались перфокарты, как и в более ранних компьютерах. Ключевое отличие заключалось в том, что теперь вместе с данными загружалась и программа для исполнения. Благодаря этому, стало возможно быстро и с минимальными затратами адаптировать компьютер к решению новых задач.

Как только компьютеры стали программируемыми, то есть пользователь получил возможность менять алгоритм их работы, возникли сложности. Загружаемые в них программы, должны были определять все требуемые от компьютера функции. Очень часто эти функции повторялись. Например операции ввода-вывода или манипуляции с оборудованием. Для экономии времени разработки этот повторяющийся код выносили в служебные программы. Они и стали прототипом будущих ОС.

// TODO: Добавить иллюстрацию про аппаратные и программные ресурсы. Отметить их разным цветом.

## Решаемые ОС задачи

Мы выяснили, что ОС позволяет значительно ускорить разработку приложений. Она предоставляет функции, которые обычно нужны программе для нормальной работы. Теперь разберёмся: что же это за функции?

Всё [**аппаратное обеспечение**](https://ru.wikipedia.org/wiki/%D0%90%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5) компьютера, т.е. его электронные и механические части, можно рассматривать как некоторые ресурсы для вычислений. Программы так или иначе пользуются ими в своих алгоритмах. Но для доступа к каждому виду ресурсов приходится следовать определённым правилам. Например, две программы не могут писать данные на [жёсткий диск](https://ru.wikipedia.org/wiki/%D0%96%D1%91%D1%81%D1%82%D0%BA%D0%B8%D0%B9_%D0%B4%D0%B8%D1%81%D0%BA#%D0%A2%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B8_%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85) в один и тот же момент времени. Запись на диск осуществляется единственной магнитной головкой. Поэтому запросы программ на запись должны быть помещены в очередь и исполняться друг за другом. За механизм обслуживания этой очереди отвечает ОС. Похожим образом организуется доступ ко всем [периферийным](https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D0%B8%D1%84%D0%B5%D1%80%D0%B8%D0%B9%D0%BD%D0%BE%D0%B5_%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%BE) и внутренним устройствам компьютера.

Аппаратные ресурсы — это не единственное, что ОС может предложить приложениям, работающим под её управлением. Кроме них есть программные ресурсы, доступ к которым также предоставляет ОС. Например, компонент Windows под названием [**интерфейс графических устройств**](https://ru.wikipedia.org/wiki/GDI) позволяет приложениям манипулировать графическими объектами. С их помощью разработчики могут создавать графический интерфейс для своих программ. К этому типу ресурсов относятся все приложения и компоненты ОС, установленные на компьютере. Кроме собственных возможностей ОС может предоставлять доступ и к алгоритмам сторонних приложений.

Кроме управления ресурсами, ОС организует работу запущенных приложений. Прежде всего код приложения должен быть загружен с [**устройства хранения информации**](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%8F_%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D1%8C) (будь то перфокарта или жёсткий диск) и помещён в [**оперативную память**](https://ru.wikipedia.org/wiki/%D0%9E%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%B0%D1%8F_%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D1%8C) компьютера. Эта процедура нетривиальная, поскольку код всех сторонних библиотек, которые требуются приложению для работы, так же должен быть загружен в оперативную память.

## Разновидности ОС

Спор о том, какая операционная система лучше, идёт не один десяток лет. Сегодня на рынке настольных компьютеров доминируют три основных семейства ОС:

* [Windows](https://ru.wikipedia.org/wiki/Windows)
* [Linux](https://ru.wikipedia.org/wiki/Linux)
* [MacOS](https://ru.wikipedia.org/wiki/MacOS)

Первые две примечательны тем, что не привязаны к конкретной аппаратной платформе. Это значит, что купив любой персональный компьютер или ноутбук, вы без особых трудностей сможете установить на него Windows или Linux. MacOS в отличие от них рассчитана на запуск только на продукции Apple. Чтобы установить её на чём-то другом, вам потребуются [модифицированная версия ОС](https://ru.wikipedia.org/wiki/OSx86).

// TODO: Чем еще они различаются в общем?

## Философия ОС

ОС во многом определяет инфраструктуру, доступную программисту. Она диктует не только доступные инструменты разработки, такие как IDE, компилятор, система сборки, но и некоторые архитектурные решения. Рассмотрим этот вопрос подробнее на примере Windows и Linux.

### Windows

Как вам известно, Windows — это проприетарная ОС. Это значит, что все её исходные коды закрыты для постороннего изучения и модификации. Вы не сможете законным способом узнать о ней больше, чем разработчики посчитают нужным вам сообщить. Чтобы установить Windows на свой компьютер, вам надо купить её у компании Microsoft. Однако, в большинстве случаев эта ОС уже предустановлена на новые компьютеры и ноутбуки, а её цена включена в стоимость устройства.

Обратите внимание, что целевая платформа Windows — это относительно дешевые персональные компьютеры. Многие могут позволить себе купить такое устройство. Это огромный рынок потребителей. Поэтому Microsoft стремится всеми силами предотвратить конкуренцию. Компания не хочет, чтобы на рынке появлялись ОС, которые бы копировали возможности Windows. Это желание совершенно справедливо и оправдано. Именно поэтому Microsoft заботится о защите своей интеллектуальной собственности не только техническими, но и юридическими путями. Строго говоря, пользовательское соглашение запрещает вам исследовать внутреннее устройство ОС.

За время существования Windows под неё было написано очень много программ. Первые из них (например пакет офисных приложений [Microsoft Office](https://ru.wikipedia.org/wiki/Microsoft_Office) или [стандартные приложения Windows](https://ru.wikipedia.org/wiki/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%A1%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F_Windows)) создавались самой компанией Microsoft. Для сторонних разработчиков они послужили в некотором роде образцом того, как правильно писать программы под Windows. Очевидно, что Microsoft при разработке своих приложений придерживалась того же принципа закрытости, что и при разработке ОС: исходные коды должны быть закрыты, форматы данных недокументированны, возможности приложений недоступны для сторонних утилит. Опять же это решение было продиктовано заботой о защите интеллектуальной собственности компании от конкурентов.

Сторонние разработчики программ последовали примеру Microsoft и стали придерживаться той же философии закрытости. Большинство получившихся приложений самодостаточны и независимы друг от друга. Форматы их данных, как правило, закодированы и недокументированны. 

Если вы опытный пользователь компьютера, вы легко сможете представить себе типичное Windows приложение. Оно представляет собой окно с такими [элементами интерфейса](https://ru.wikipedia.org/wiki/%D0%AD%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0), как кнопки, поля ввода, вкладки и т.д. Через это окно пользователь манипулирует данными (например текстом, изображением, звуковой записью и т.д.). Результат работы сохраняется на жёсткий диск компьютера и может быть повторно загружен. Скорее всего, если вы напишете собственное приложение, оно будет работать похожим образом. Именно подобную преемственность я и имел в виду, когда говорил об архитектурных решениях, продиктованных ОС.

### Linux

Linux является идейным наследником ОС [Unix](https://ru.wikipedia.org/wiki/Unix) и следует её спецификациям. Следование спецификациям означает заимствование идей и решений, что в результате приводит к похожему поведению.

Сама Unix возникла в конце 1960-х годов. Она разрабатывалась как хобби проект двух инженеров компании Bell Labs: Кеном Томпсоном и Деннисом Ритчи. Всё началось с того, что Кен разработал компьютерную игру [Space Travel](https://ru.wikipedia.org/wiki/Space_Travel). Она запускалась на [мэйнфреймах](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D0%B9%D0%BD%D1%84%D1%80%D0%B5%D0%B9%D0%BC) компании General Electric, работающих под управлением ОС GECOS. Такие компьютеры стоили дорого, и их вычислительные ресурсы активно использовались для нужд компании. Поэтому Кен решил портировать свою игру на относительно недорогой компьютер [PDP-7](https://ru.wikipedia.org/wiki/PDP-7) стоимостью порядка 72000$. Проблема была в том, что игра использовала возможности ОС GECOS, которые были недоступны на PDP-7. Поэтому Кену и присоединившемуся к нему Деннису пришлось реализовать несколько библиотек и систем, которые впоследствии развились в Unix.

Очевидно, в своём проекте разработчики Unix не заботились о защите интеллектуальной собственности, поскольку не собирались продавать свою ОС. Она распространялась с открытым исходным кодом, доступным для изучения и модификации любым желающим. Изначально круг пользователей ограничивался сотрудниками компании Bell Labs. Позднее AT&T, которой принадлежала Bell Labs, предоставила исходный код Unix высшим учебным заведениям США. Таким образом развитие ОС продолжилось в университетских кругах.

Linux была создана в 1991 году Линусом Торвальдсом во время его обучения в Хельсинкском университете. Как и у создателей Unix, у него не было коммерческих интересов, связанных с продажей своей ОС. Поэтому она стала бесплатна и свободно распространялась с исходным кодом через Интернет.

На самом деле Linux — это не более чем ядро ОС, предоставляющее функции для работы с памятью, файловой системой, периферийными устройствами, а также управлением процессорным временем. Большинство функций системы были доступны через свободные [пользовательские компоненты GNU](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82_GNU), которые Линус включил в [дистрибутив](https://ru.wikipedia.org/wiki/%D0%94%D0%B8%D1%81%D1%82%D1%80%D0%B8%D0%B1%D1%83%D1%82%D0%B8%D0%B2_Linux) своей ОС.

Изначально у Linux, как у и Unix, не было графической подсистемы. Все приложения пользователь запускал из [командной строки](https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81_%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4%D0%BD%D0%BE%D0%B9_%D1%81%D1%82%D1%80%D0%BE%D0%BA%D0%B8). В неё же печатались результаты их исполнения. Некоторые из сложных приложений имели [оконный текстовый интерфейс](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%B2%D1%8B%D0%B9_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F#%D0%9E%D1%81%D0%BE%D0%B1%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0) пользователя. Со временем в Linux появилась оконная система [X Window System](https://ru.wikipedia.org/wiki/X_Window_System), а вместе с ней и более привычные Windows пользователям приложения с графическим интерфейсом.

Инфраструктура, в которой возник и развивался Linux, во многом определила культуру написания приложений. В ней предпочтение отдаётся узкоспециализированным утилитам командной строки, которые выполняют одну конкретную задачу. Результат работы таких утилит доступен для распространения через открытый формат данных (обычно [текстовый](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%B2%D1%8B%D0%B5_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5)), который можно прочитать в обычном текстовом редакторе. Исходный код самих утилит, как правило, доступен для модификации.

Культура Linux значительно отличается от стандартов разработки, принятых в Windows. Там каждое приложение монолитно и самостоятельно выполняет все необходимые для своей работы задачи. Оно не полагается на сторонние утилиты, которые могут оказаться платными или недоступными для пользователя по какой-то причине. Разработчик должен полагаться только на себя. Он не может требовать от пользователя купить что-то дополнительное для работы своего приложения. В Linux же подавляющее большинство утилит бесплатны, взаимозаменяемы и легко доступны через Интернет. Поэтому вполне естественно, что какое-то приложение попросит установить и скачать недостающие ему системные компоненты.

Даже монолитные графические приложения в Linux очень часто имеют текстовый интерфейс. Таким образом они органично вписываются в экосистему и легко интегрируются с другими утилитами и приложениями.

Когда сложный вычислительный процесс строится на использовании набора отдельных узкоспециализированных приложений, становится насущным вопрос написания сценариев, по которому они должны выполняться. Именно для этой задачи была создана [командная оболочка](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4%D0%BD%D0%B0%D1%8F_%D0%BE%D0%B1%D0%BE%D0%BB%D0%BE%D1%87%D0%BA%D0%B0_Unix) [Bourne shell](https://ru.wikipedia.org/wiki/Bourne_shell) и её потомок [Bash](https://ru.wikipedia.org/wiki/Bash).